<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>如何去除hexo底部强力驱动标记</title>
    <url>/2022/02/15/deleteHexoLogo/</url>
    <content><![CDATA[<p style="text-indent:2em;">Hexo博客搭建好后,底部的"由 Hexo & NexT.Mist 强力驱动"的字样属实让人头疼。虽然我爱你,但把你名字纹在大腿大可不必！</p>
<p style="text-indent:2em;">找到Blog\themes\next\layout\_partials下的footer.swig,定位51行,删除footer.powered url这行即可！</p>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">&#123;<span class="operator">%</span><span class="operator">-</span> if theme.footer.powered <span class="operator">%</span>&#125;</span><br><span class="line">  <span class="operator">&lt;</span>div class<span class="operator">=</span>&quot;powered-by&quot;<span class="operator">&gt;</span></span><br><span class="line">    &#123;<span class="operator">%</span><span class="operator">-</span> <span class="keyword">set</span> next_site <span class="operator">=</span> <span class="string">&#x27;https://theme-next.org&#x27;</span> <span class="operator">%</span>&#125;</span><br><span class="line">    &#123;<span class="operator">%</span><span class="operator">-</span> if theme.scheme <span class="operator">!=</span><span class="operator">=</span> <span class="string">&#x27;Gemini&#x27;</span> <span class="operator">%</span>&#125;</span><br><span class="line">      &#123;<span class="operator">%</span><span class="operator">-</span> <span class="keyword">set</span> next_site <span class="operator">=</span> <span class="string">&#x27;https://&#x27;</span> <span class="operator">+</span> theme.scheme <span class="operator">|</span> lower <span class="operator">+</span> <span class="string">&#x27;.theme-next.org&#x27;</span> <span class="operator">%</span>&#125;</span><br><span class="line">    &#123;<span class="operator">%</span><span class="operator">-</span> endif <span class="operator">%</span>&#125;</span><br><span class="line">    &#123;&#123;<span class="operator">-</span> __(<span class="string">&#x27;footer.powered&#x27;</span>, next_url(<span class="string">&#x27;https://hexo.io&#x27;</span>, <span class="string">&#x27;Hexo&#x27;</span>, &#123;class: <span class="string">&#x27;theme-link&#x27;</span>&#125;) <span class="operator">+</span> <span class="string">&#x27; &amp; &#x27;</span> <span class="operator">+</span> next_url(next_site, <span class="string">&#x27;NexT.&#x27;</span> <span class="operator">+</span> theme.scheme, &#123;class: <span class="string">&#x27;theme-link&#x27;</span>&#125;)) &#125;&#125;</span><br><span class="line">  <span class="operator">&lt;</span><span class="operator">/</span>div<span class="operator">&gt;</span></span><br><span class="line">&#123;<span class="operator">%</span><span class="operator">-</span> endif <span class="operator">%</span>&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Hexo</category>
        <category>trouble</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>hadoop进程异常检测重启</title>
    <url>/2022/02/09/hadoopRoot/</url>
    <content><![CDATA[<p style="text-indent:2em;">各位在搭建完Hadoop后，是不是会偶尔出现进程挂掉的情况呢？这里的进程指的是NameNode/DataNode/ResourceManager/NodeManager等。在排除搭建时有问题外，写一套自动检测重启的脚本，就非常有必要了。</p>
<p style="text-indent:2em;">这里介绍一个shell方法，每间隔60s检测一次，发现异常即重启，并将重启记录写入MySQL，便于后续分析</p>
<p style="text-indent:2em;">首先要在MySQL的bigdata库建表:</p>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> bigdata.hadoop_process_log (</span><br><span class="line">	`node` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;节点&#x27;</span>,</span><br><span class="line">	`typeName` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;进程类型&#x27;</span>,</span><br><span class="line">	`logtime` datetime <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;大数据hadoop进程重启记录表&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>脚本如下：<BR></BR></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash </span></span><br><span class="line"><span class="comment"># 功能：检测Hadoop进程</span></span><br><span class="line"><span class="comment"># Create：hst</span></span><br><span class="line"><span class="comment"># Time：2022-01-25 14:50:00</span></span><br><span class="line"><span class="comment"># Last Modify Developer：husongtao</span></span><br><span class="line"><span class="comment"># Last Modify Time：2022-01-25 14:50:00</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> :</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line"></span><br><span class="line">rebootYarnFlag=0</span><br><span class="line">rebootHdfsFlag=0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#方法1：检测hadoop进程</span></span><br><span class="line"><span class="function"><span class="title">Fn_CheckHdp</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">	ssh -p 52001 <span class="variable">$1</span> <span class="string">&quot;<span class="variable">$JAVA_HOME</span>/bin/jps|egrep -w <span class="variable">$2</span>&quot;</span> &gt; /dev/null</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#方法2：重启hadoop进程</span></span><br><span class="line"><span class="comment">#为调用方便，ip端口写死在里面，需手动修改</span></span><br><span class="line"><span class="function"><span class="title">Fn_RebootHdp</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">case</span> <span class="variable">$1</span> <span class="keyword">in</span></span><br><span class="line">	<span class="string">&quot;yarn&quot;</span>)</span><br><span class="line">	ssh -p 52001 hadoop3-215 <span class="string">&quot;sh <span class="variable">$HADOOP_HOME</span>/sbin/stop-yarn.sh; sh <span class="variable">$HADOOP_HOME</span>/sbin/start-yarn.sh&quot;</span>  &gt; /dev/null</span><br><span class="line">	rebootYarnFlag=1</span><br><span class="line">	;;</span><br><span class="line">	<span class="string">&quot;hdfs&quot;</span>)</span><br><span class="line">	ssh -p 52001 hadoop3-215 <span class="string">&quot;sh <span class="variable">$HADOOP_HOME</span>/sbin/stop-dfs.sh;sh <span class="variable">$HADOOP_HOME</span>/sbin/start-dfs.sh&quot;</span>   &gt; /dev/null</span><br><span class="line">	rebootHdfsFlag=1</span><br><span class="line">	;;</span><br><span class="line">	*)</span><br><span class="line">	<span class="keyword">esac</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#方法3：hadoop进程失败记录写入MySQL</span></span><br><span class="line"><span class="comment">#为调用方便，ip端口用户密码 写死在里面，需手动修改</span></span><br><span class="line"><span class="function"><span class="title">Fn_LoadHdpLog</span></span>()</span><br><span class="line">&#123;</span><br><span class="line">	sql=<span class="string">&quot;insert into hadoop_process_log(node,typename) values(\&quot;<span class="variable">$1</span>\&quot;,\&quot;<span class="variable">$2</span>\&quot;)&quot;</span></span><br><span class="line">	<span class="comment">#echo &quot;$sql&quot;</span></span><br><span class="line">	mysql -hhadoop3-217 -uroot -p111111 -P23306 bigdata -e <span class="string">&quot;<span class="variable">$sql</span>&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#=================== 检查ResourceManager、NameNode服务器 ===================</span></span><br><span class="line">	<span class="comment">#1.检测 ResourceManager 进程</span></span><br><span class="line">	Fn_CheckHdp hadoop3-215 ResourceManager</span><br><span class="line">	<span class="keyword">if</span> [ 0 -ne $? ]</span><br><span class="line">	<span class="keyword">then</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;ResourceManager异常,即将重启YARN进程&quot;</span></span><br><span class="line">		Fn_RebootHdp yarn</span><br><span class="line">		Fn_LoadHdpLog hadoop3-215 ResourceManager</span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">#2.检测 NameNode 进程</span></span><br><span class="line">	Fn_CheckHdp hadoop3-215 NameNode</span><br><span class="line">	<span class="keyword">if</span> [ 0 -ne $? ]</span><br><span class="line">	<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;NameNode异常,即将重启HDFS进程&quot;</span></span><br><span class="line">		Fn_RebootHdp hdfs</span><br><span class="line">		Fn_LoadHdpLog hadoop3-215 NameNode</span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">#=================== 检查其他服务器 ===================	</span></span><br><span class="line"><span class="keyword">for</span> host <span class="keyword">in</span> hadoop3-213 hadoop3-214 hadoop3-215  hadoop3-216 hadoop3-217 hadoop3-218 hadoop3-219</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">	<span class="built_in">echo</span> ====================    <span class="variable">$host</span>    ====================</span><br><span class="line"></span><br><span class="line">	<span class="comment">##1.检测 NodeManager 进程</span></span><br><span class="line">	Fn_CheckHdp <span class="variable">$host</span> NodeManager</span><br><span class="line">	<span class="keyword">if</span> [ 0 -ne $? ] &amp;&amp; [ <span class="variable">$rebootYarnFlag</span> -eq 0 ]</span><br><span class="line">	<span class="keyword">then</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;NodeManager异常,即将重启yarn进程&quot;</span></span><br><span class="line">		Fn_RebootHdp yarn</span><br><span class="line">		Fn_LoadHdpLog <span class="variable">$host</span> NodeManager</span><br><span class="line">	<span class="keyword">fi</span>	</span><br><span class="line">	</span><br><span class="line">	<span class="comment">##2.检测 DataNode 进程</span></span><br><span class="line">	Fn_CheckHdp <span class="variable">$host</span> DataNode</span><br><span class="line">	<span class="keyword">if</span> [ 0 -ne $? ] &amp;&amp; [ <span class="variable">$rebootHdfsFlag</span> -eq 0 ]</span><br><span class="line">	<span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;DataNode异常,即将重启HDFS进程&quot;</span></span><br><span class="line">		Fn_RebootHdp hdfs</span><br><span class="line">		Fn_LoadHdpLog <span class="variable">$host</span> DataNode</span><br><span class="line">	<span class="keyword">fi</span>	</span><br><span class="line">	</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Hadoop进程检测完毕！&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">sleep</span> 60</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>各位小伙伴记得修改哦，不要把主机端口等参数弄错了！最后后台运行就可以了，日志表如下图：<BR> </BR></p>
<img src="/2022/02/09/hadoopRoot/1.png" class title="这是一个新的博客的图片的说明">
]]></content>
      <categories>
        <category>大数据</category>
        <category>Hadoop</category>
      </categories>
      <tags>
        <tag>大数据</tag>
        <tag>shell</tag>
      </tags>
  </entry>
</search>
